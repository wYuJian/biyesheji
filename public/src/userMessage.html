<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>留言处理</title>
    <link rel="stylesheet" href="../stylesheets/userMessage.css">
    <script src="//at.alicdn.com/t/font_399103_hqtvf6oym7xmvx6r.js"></script>
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
        function upComStatus(id){
            $.post('../upMesStatus',{
                'id':id
            },function(data,status){
                $.post('../messageSuccess',function(data,status){
                    $('.content').empty();
                    data.forEach(function(list){
                        if(list.message_status == 1){
                            $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon2" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli"></use>
                              </svg></p></div>
                              <div class="fl">
                                    <a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                         <use xlink:href="#icon-shanchu"></use>
                                     </svg></a>
                              </div>
                            </li>`);
                        }else{
                            $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon" aria-hidden="true">
                                  <use xlink:href="#icon-daichuli"></use>
                              </svg></p></div>
                              <div class="fl"><a href="javascript:void(0)" title="处理" onclick="upComStatus(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli1"></use>
                              </svg></a><a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-shanchu"></use>
                              </svg></a></div>
                           </li>`);
                        }
                    })
                })
            })
        }
        function delCom(id){
            $.post('../delMes',{'id':id},function(data,status){
                if(data.code == true){
                    alert('删除成功！');
                    $.post('../userComSuccess',function(data,status){
                        $('.content').empty();
                        data.forEach(function(list){
                            if(list.com_status == 1){
                                $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.com_phone}</p></div>
                              <div class="fl"><p>${list.com_type}</p></div>
                              <div class="fl"><p>${list.com_subject}</p></div>
                              <div class="fl"><p>${list.com_content}</p></div>
                              <div class="fl"><p><svg class="icon2" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli"></use>
                              </svg></p></div>
                              <div class="fl">
                                    <a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                         <use xlink:href="#icon-shanchu"></use>
                                     </svg></a>
                              </div>
                            </li>`);
                            }else{
                                $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.com_phone}</p></div>
                              <div class="fl"><p>${list.com_type}</p></div>
                              <div class="fl"><p>${list.com_subject}</p></div>
                              <div class="fl"><p>${list.com_content}</p></div>
                              <div class="fl"><p><svg class="icon" aria-hidden="true">
                                  <use xlink:href="#icon-daichuli"></use>
                              </svg></p></div>
                              <div class="fl"><a href="javascript:void(0)" title="处理" onclick="upComStatus(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli1"></use>
                              </svg></a><a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-shanchu"></use>
                              </svg></a></div>
                           </li>`);
                            }
                        })
                    })
                }else{
                    alert('删除失败！')
                }
            })
        }
        $(function () {
            $.post('../messageSuccess',function(data,status){
                $('.content').empty();
                data.forEach(function(list){
                    if(list.message_status == 1){
                        $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon2" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli"></use>
                              </svg></p></div>
                              <div class="fl">
                                    <a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                         <use xlink:href="#icon-shanchu"></use>
                                     </svg></a>
                              </div>
                            </li>`);
                    }else{
                        $('.content').append(` <li>
                              <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon" aria-hidden="true">
                                  <use xlink:href="#icon-daichuli"></use>
                              </svg></p></div>
                              <div class="fl"><a href="javascript:void(0)" title="处理" onclick="upComStatus(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli1"></use>
                              </svg></a><a href="javascript:void(0)" title="删除"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-shanchu"></use>
                              </svg></a></div>
                           </li>`);
                    }
                })
            })
            $('input:radio[name="status"]').on('click',function(){
                var  status =  $(this).val();
                $.post('../messageSuccess',{
                    status:status
                },function(data,status){
                    $('.content').empty();
                    data.forEach(function(list){
                        if(list.message_status == 1){
                            $('.content').append(` <li>
                             <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon2" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli"></use>
                              </svg></p></div>
                              <div class="fl">
                                    <a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                         <use xlink:href="#icon-shanchu"></use>
                                     </svg></a>
                              </div>
                            </li>`);
                        }else{
                            $('.content').append(` <li>
                            <div class="fl"><p>${list.id}</p></div>
                              <div class="fl"><p>${list.username}</p></div>
                              <div class="fl"><p>${list.message_phone}</p></div>
                              <div class="fl"><p>${list.message_type}</p></div>
                              <div class="fl"><p>${list.message_subject}</p></div>
                              <div class="fl"><p>${list.message_content}</p></div>
                              <div class="fl"><p><svg class="icon" aria-hidden="true">
                                  <use xlink:href="#icon-daichuli"></use>
                              </svg></p></div>
                              <div class="fl"><a href="javascript:void(0)" title="处理" onclick="upComStatus(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-yichuli1"></use>
                              </svg></a><a href="javascript:void(0)" title="删除" onclick="delCom(${list.id})"><svg class="icon3" aria-hidden="true">
                                  <use xlink:href="#icon-shanchu"></use>
                              </svg></a></div>
                           </li>`);
                        }
                    })
                })
            })
        })
    </script>
</head>
<body>
<div>
    位置：反馈处理->留言信息
</div>
<div>
    <input type="radio" name='status'  value="all" checked='checked'>全部
    <input type="radio" name='status' value="0">未处理
    <input type="radio" name='status' value="1">已处理
</div>
<ul class="tab">
    <li>ID</li>
    <li>用户名</li>
    <li>联系电话</li>
    <li>类型</li>
    <li>主题</li>
    <li>内容</li>
    <li>状态</li>
    <li>操作</li>
</ul>
<ul class="content">
    <!--<li>-->
        <!--<div class="fl"><p>1</p></div>-->
        <!--<div class="fl"><p>test</p></div>-->
        <!--<div class="fl"><p>13123132003</p></div>-->
        <!--<div class="fl"><p>留言</p></div>-->
        <!--<div class="fl"><p>测试留言</p></div>-->
        <!--<div class="fl"><p>这是测试</p></div>-->
        <!--<div class="fl"><p>未处理</p></div>-->
        <!--<div class="fl"><a href="">处理</a><a href="">删除</a></div>-->
    <!--</li>-->
</ul>
</body>
</html>